---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { sanity, blogListQuery } from '../../lib/sanity.ts';

const posts = await sanity.fetch(blogListQuery).catch(() => []);
---
<BaseLayout title="Blog â€” Firecast">
  <h1>Blog</h1>
  {posts.length === 0 ? (
    <p>No posts yet. Connect Sanity to show content.</p>
  ) : (
    <ul>
      {posts.map((p) => (
        <li>
          <a href={`/blog/${p.slug}`}>{p.title}</a>
          <div style="color:#6b7c95;font-size:14px">{new Date(p.publishedAt).toLocaleDateString()}</div>
          <p>{p.excerpt || ''}</p>
        </li>
      ))}
    </ul>
  )}
</BaseLayout>
