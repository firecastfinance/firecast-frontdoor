---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { sanity, blogListQuery } from '../../lib/sanity';
import type { PostListItem } from '../../types/content';

const posts = (await sanity.fetch(blogListQuery).catch(() => [])) as PostListItem[];
---
<BaseLayout title="Blog â€” Firecast">
  <h1>Blog</h1>
  {posts.length === 0 ? (
    <p>No posts yet. Connect Sanity to show content.</p>
  ) : (
    <ul>
      {posts.map(({ slug, title, publishedAt, excerpt }) => (
        <li>
          <a href={`/blog/${slug}`}>{title}</a>
          <div style="color:#6b7c95;font-size:14px">
            {publishedAt ? new Date(publishedAt).toLocaleDateString() : ''}
          </div>
          <p>{excerpt || ''}</p>
        </li>
      ))}
    </ul>
  )}
</BaseLayout>

